#!/usr/bin/env node

var fs      = require('fs'),
    util    = require('util'),
    jsdom   = require('jsdom'),
    program = require('commander');

program
	.version( JSON.parse(fs.readFileSync(__dirname + '/../package.json', 'utf8')).version )
	.option('-p, --paragraphs [number]', 'Number of paragraphs to generate')
	.option('-c, --no-cussin', 'Keep it squeaky clean for client work')
	.option('-l, --lebowskiipsum', 'Start the first paragraph with "Lebowski Ipsum"')
	.option('-t, --html', 'Wrap your filler text in zee HTML tacs, OK?')
	.parse(process.argv);

var url = 'http://lebowskiipsum.com/dude/generate' +
          '/paragraphs/' + (program.paragraphs || 5) +
          '/cussin/' + (program.cussin || 'false') +
          '/mixed/false' +
          '/startleb/' + (program.lebowskiipsum || 'false') +
          '/html/' + (program.html || 'false') +
          '/characters/1';

jsdom.env({
	html: url,
	done: function(errors, window) {
		var content;
		if (!errors && window && (result = window.document.getElementById('lebowskiIpsum'))) {
			content = result.value;
		}
		if (!content) {
			util.debug('Well, uh ... looks like you got the wrong guy.');
			return;
		}
		console.log(content);
	}
});
